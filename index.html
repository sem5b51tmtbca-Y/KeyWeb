<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Key Generator</title>

    <style>
    body {
        font-family: Arial, sans-serif;
        background: #f2f2f2;
        padding: 20px;
    }

    .panel {
        background: white;
        max-width: 480px;
        margin: auto;
        padding: 18px;
        border-radius: 6px;
        box-shadow: 0 0 10px rgba(0,0,0,0.15);
    }

  

    .row {
        display: flex;
        align-items: center;
        margin-bottom: 20px;
    }

    label {
        width: 95px;
        font-weight: bold;
    }

    /* === FIXED INPUT STYLING === */
    input[type="text"],
    input[type="number"],
    input[type="password"] {
        flex: 1;
        padding: 8px;
        border: 1px solid #ccc;
        border-radius: 4px;
        box-sizing: border-box; /* makes all inputs same width */
    }

  

    button:hover {
        background: #0056b3;
    }

      /* === CUSTOM RADIO BUTTONS === */
    .radio-group {
        display: flex;
        gap: 15px;
        margin-bottom: 25px;
        flex-wrap: wrap; /* in case screen is small */
    }

    .custom-radio {
        display: flex;
        align-items: center;
        cursor: pointer;
        position: relative;
        font-weight: normal;
        user-select: none;
    }

    .custom-radio input {
        position: absolute;
        opacity: 0; /* hide default radio */
        cursor: pointer;
    }

    .radio-circle {
        width: 18px; /* outer circle diameter */
        height: 18px;
        border: 2px solid rgb(0, 70, 140); /* outer circle color */
        border-radius: 50%;
        margin-right: 6px;
        position: relative;
        display: inline-block;
    }

    /* inner circle when checked */
    .custom-radio input:checked + .radio-circle::after {
        content: "";
        width: 13px; /* inner circle diameter */
        height: 13px;
        background: rgb(0, 70, 140); /* inner circle color */
        border-radius: 50%;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
    }
    
    /* === CUSTOM GRADIENT BUTTON === */
.gradient-button {
    width: 100%;
    padding: 10px;
    font-size: 16px;
    font-weight: bold;
    color: midnightblue;
    cursor: pointer;

    border: 2px solid rgb(0,70,140);
    border-radius: 6px;

    /* === RECTANGULAR EMERALD CORE (WHITE CENTER) === */
      background:
       
        /* horizontal rectangle */
        linear-gradient(to right,
            rgb(0,70,140) 0%,
            rgb(0,70,140) 30%,
            white 40%,
            white 60%,
            rgb(0,70,140) 70%,
            rgb(0,70,140) 100%
        );

    background-blend-mode: lighten;
 
}

    
</style>
</head>

<body>

    <!-- LOGIN PANEL -->
<div class="panel" id="loginPanel">
    <h3 style="text-align:center">Login</h3>

    <div class="row">
        <label>User:</label>
        <input type="text" id="loginUser">
    </div>

    <div class="row">
        <label>Password:</label>
        <input type="password" id="loginPass">
    </div>

     <button class="gradient-button" onclick="login()">Login</button>
</div>

<!-- KEY GENERATOR PANEL (HIDDEN UNTIL LOGIN) -->
<div class="panel" id="appPanel" style="display:none">

    <!-- MODE RADIO BUTTONS -->
    <div class="radio-group">
        <label class="custom-radio">
            <input type="radio" name="mode" id="RbSawing" checked>
            <span class="radio-circle"></span>
            Sawing
        </label>

        <label class="custom-radio">
            <input type="radio" name="mode" id="RbShape">
            <span class="radio-circle"></span>
            Shape
        </label>

        <label class="custom-radio">
            <input type="radio" name="mode" id="RbMulti">
            <span class="radio-circle"></span>
            Multi
        </label>

        <label class="custom-radio">
            <input type="radio" name="mode" id="Rb4P">
            <span class="radio-circle"></span>
            4P
        </label>
    </div>

    <!-- MACHINE ID -->
    <div class="row">
        <label>MachineID:</label>
        <input type="text" id="TxtMachinID">
    </div>

    <!-- DAYS -->
    <div class="row">
        <label>Days:</label>
        <input type="number" id="NoofDay">
    </div>

    <!-- KEY -->
    <div class="row">
        <label>Key:</label>
        <input type="text" id="TxtKey">
    </div>

    <!-- GENERATE BUTTON -->
      <button class="gradient-button" id="BtnKeyGen" onclick="generateKey()">
        Key Generate
    </button>

</div>

<script>
    /* ===== LOGIN LOGIC ===== */
const USERNAME = "utpladmin";   // set your username
const PASSWORD = "ut2025";    // set your password

function login() {
    const u = document.getElementById("loginUser").value.trim();
    const p = document.getElementById("loginPass").value.trim();

    if (u === USERNAME && p === PASSWORD) {
        document.getElementById("loginPanel").style.display = "none";
        document.getElementById("appPanel").style.display = "block";
    } else {
        alert("Invalid username or password");
    }
}

/* ===== KEY GENERATOR LOGIC ===== */
function generateKey() {

    const machineIdFull = document.getElementById("TxtMachinID").value.trim();
    const days = document.getElementById("NoofDay").value.trim();

    if (!machineIdFull || !days) {
        alert("Please enter Machine ID and Days");
        return;
    }

    // MODE
    let modeCode = "X";

     if (document.getElementById("RbSawing").checked) modeCode = "S";
    else if (document.getElementById("RbShape").checked) modeCode = "H";
    else if (document.getElementById("RbMulti").checked) modeCode = "M";
    else if (document.getElementById("Rb4P").checked) modeCode = "P";

    // SAME slicing as C#
    const thirdDigit = machineIdFull.substring(2, 3);
    const lastFourDigits = machineIdFull.substring(machineIdFull.length - 4);
    const machineID = thirdDigit + lastFourDigits;

    // Current date (same format)
    const today = new Date().toISOString().split("T")[0];

    // Combine EXACTLY like C#
    const combined = `${machineID}|${days}|${today}|${modeCode}`;

    // Encode
    const encoded = base32Encode(new TextEncoder().encode(combined));

    document.getElementById("TxtKey").value = encoded;
}

/* ===== BASE32 (SAME AS C#) ===== */
function base32Encode(bytes) {
    const base32Chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ234567";
    let result = "";
    let bitIndex = 0;
    let currentByte = 0;

    for (let i = 0; i < bytes.length; i++) {
        currentByte = (currentByte << 8) | bytes[i];
        bitIndex += 8;

        while (bitIndex >= 5) {
            bitIndex -= 5;
            const index = (currentByte >> bitIndex) & 0x1F;
            result += base32Chars[index];
        }
    }

    if (bitIndex > 0) {
        const index = (currentByte << (5 - bitIndex)) & 0x1F;
        result += base32Chars[index];
    }

    return result;
}
</script>

</body>
</html>
